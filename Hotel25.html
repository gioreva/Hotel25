<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Room Control - Premium Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #13131a;
            --bg-card: rgba(255, 255, 255, 0.03);
            --bg-card-hover: rgba(255, 255, 255, 0.06);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: #a8a8b3;
            --status-free: #22c55e;
            --status-occupied: #3b82f6;
            --status-assigned: #f97316;
            --status-maintenance: #f59e0b;
            --status-alarm: #ef4444;
            --status-checkout: #a855f7;
            --status-cleaning: #6b7280;
            --shadow-glow: 0 0 30px rgba(59, 130, 246, 0.5);
            --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Animated background */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(168, 85, 247, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 40% 40%, rgba(34, 197, 94, 0.05) 0%, transparent 50%);
            animation: backgroundShift 20s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes backgroundShift {
            0%, 100% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
        }

        /* Header */
        .header {
            background: rgba(19, 19, 26, 0.8);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            padding: 1.5rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            transition: var(--transition-smooth);
        }

        .header-content {
            width: 100%;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 2rem;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #3b82f6 0%, #a855f7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo::before {
            content: 'üè®';
            font-size: 1.8rem;
            -webkit-text-fill-color: initial;
        }

        /* Stats Bar */
        .stats-bar {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            border: 1px solid var(--glass-border);
            transition: var(--transition-smooth);
        }

        .stat-item:hover {
            background: rgba(255, 255, 255, 0.06);
            transform: translateY(-2px);
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Controls */
        .controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .search-box {
            position: relative;
        }

        .search-input {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 0.75rem 1rem 0.75rem 2.5rem;
            color: var(--text-primary);
            font-size: 0.875rem;
            width: 250px;
            height: 48px;
            box-sizing: border-box;
            transition: var(--transition-smooth);
        }

        .search-input::placeholder {
            color: var(--text-secondary);
        }

        .search-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(59, 130, 246, 0.5);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        .filter-btn, .view-toggle {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 0.75rem 1.25rem;
            color: var(--text-primary);
            font-size: 0.875rem;
            cursor: pointer;
            transition: var(--transition-smooth);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            height: 48px;
        }

        .filter-btn:hover, .view-toggle:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }

        /* Filter Pills */
        .filter-pills {
            padding: 1rem 2rem;
            background: rgba(19, 19, 26, 0.5);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }

        .filter-pills::-webkit-scrollbar {
            display: none;
        }

        .filter-pill {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: var(--transition-smooth);
            border: 1px solid var(--glass-border);
            background: rgba(255, 255, 255, 0.03);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-pill:hover {
            background: rgba(255, 255, 255, 0.06);
            transform: translateY(-1px);
        }

        .filter-pill.active {
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.5);
            color: #3b82f6;
        }

        /* Room Grid */
        .room-grid {
            padding: 2rem;
            width: 100%;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 1rem;
            animation: fadeInUp 0.6s ease-out;
        }

        /* Alarm Card in Room Grid */
        .alarm-room-card {
            background: var(--bg-card);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(239, 68, 68, 0.6);
            border-radius: 16px;
            padding: 0.75rem;
            cursor: default;
            position: relative;
            overflow: hidden;
            height: 70px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            grid-column: 1 / -1;
            animation: alarmGlow 2s infinite;
            box-shadow: 0 10px 40px rgba(239, 68, 68, 0.2);
            margin-bottom: 1rem;
        }

        @keyframes alarmGlow {
            0%, 100% { 
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4), 0 10px 40px rgba(239, 68, 68, 0.2); 
                border-color: rgba(239, 68, 68, 0.6);
            }
            50% { 
                box-shadow: 0 0 0 8px rgba(239, 68, 68, 0), 0 10px 40px rgba(239, 68, 68, 0.4);
                border-color: rgba(239, 68, 68, 0.8);
            }
        }

        .alarm-room-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--status-alarm);
        }

        .alarm-room-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .alarm-room-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--status-alarm);
            display: flex;
            align-items: center;
            gap: 0.375rem;
            position: absolute;
            top: 50%;
            left: 0.75rem;
            transform: translateY(-50%);
        }

        .alarm-room-icon {
            font-size: 1.25rem;
            animation: alarmPulse 1s ease-in-out infinite;
            color: var(--status-alarm);
        }

        .alarm-room-text {
            color: var(--status-alarm);
            font-size: 0.875rem;
            opacity: 0.9;
            font-weight: 500;
        }

        .alarm-room-actions {
            display: flex;
            flex-direction: row;
            gap: 1rem;
            justify-content: center;
            align-items: center;
            position: absolute;
            bottom: 0.5rem;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
        }

        .alarm-room-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            padding: 0.5rem 0.75rem;
            color: var(--text-primary);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.75rem;
            display: flex !important;
            align-items: center;
            gap: 0.375rem;
            justify-content: center;
            position: relative;
            overflow: hidden;
            white-space: nowrap;
            visibility: visible !important;
            opacity: 1 !important;
            height: auto !important;
        }

        .alarm-room-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s;
        }

        .alarm-room-btn:hover::before {
            left: 100%;
        }

        .alarm-room-btn:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .alarm-room-btn.primary {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2) 0%, rgba(220, 38, 38, 0.2) 100%);
            border-color: rgba(239, 68, 68, 0.4);
            color: var(--status-alarm);
        }

        .alarm-room-btn.primary:hover {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.3) 0%, rgba(220, 38, 38, 0.3) 100%);
            border-color: rgba(239, 68, 68, 0.6);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.2);
        }

        .alarm-room-btn.muted {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.2) 0%, rgba(147, 51, 234, 0.2) 100%);
            border-color: rgba(168, 85, 247, 0.4);
            color: #a855f7;
        }

        .alarm-room-btn.muted:hover {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.3) 0%, rgba(147, 51, 234, 0.3) 100%);
            border-color: rgba(168, 85, 247, 0.6);
            box-shadow: 0 8px 25px rgba(168, 85, 247, 0.2);
        }

        .mute-icon {
            font-size: 1rem;
        }

        @keyframes alarmPulse {
            0%, 100% {
                transform: scale(1);
                filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5));
            }
            50% {
                transform: scale(1.2);
                filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.8));
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Room Card */
        .room-card {
            background: var(--bg-card);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1rem;
            cursor: pointer;
            transition: var(--transition-smooth);
            position: relative;
            overflow: hidden;
            height: 140px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .room-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            transition: var(--transition-smooth);
        }

        .room-card.free::before { background: var(--status-free); }
        .room-card.occupied::before { background: var(--status-occupied); }
        .room-card.assigned::before { background: var(--status-assigned); }
        .room-card.maintenance::before { background: var(--status-maintenance); }
        .room-card.alarm::before { background: var(--status-alarm); }
        .room-card.checkout::before { background: var(--status-checkout); }
        .room-card.cleaning::before { background: var(--status-cleaning); }

        .room-card:hover {
            background: var(--bg-card-hover);
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .room-card.alarm {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
        }

        .room-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }

        .room-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1;
        }

        .room-type {
            font-size: 0.75rem;
            color: var(--text-secondary);
            background: rgba(255, 255, 255, 0.05);
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
            line-height: 1;
        }

        .room-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .status-icon {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .room-card.free .status-icon { background: var(--status-free); }
        .room-card.occupied .status-icon { background: var(--status-occupied); }
        .room-card.assigned .status-icon { background: var(--status-assigned); }
        .room-card.maintenance .status-icon { background: var(--status-maintenance); }
        .room-card.alarm .status-icon { background: var(--status-alarm); }
        .room-card.checkout .status-icon { background: var(--status-checkout); }
        .room-card.cleaning .status-icon { background: var(--status-cleaning); }

        .status-text {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .guest-name {
            font-size: 0.875rem;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .room-info {
            display: flex;
            gap: 0.75rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        /* Quick Actions (visible on hover) */
        .quick-actions {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            padding: 0.5rem;
            display: flex;
            justify-content: space-around;
            transform: translateY(100%);
            transition: var(--transition-smooth);
        }

        .room-card:hover .quick-actions {
            transform: translateY(0);
        }

        .action-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            padding: 0.5rem;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition-smooth);
            font-size: 1rem;
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 2rem;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--glass-border);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .close-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 0.5rem;
            cursor: pointer;
            transition: var(--transition-smooth);
            color: var(--text-primary);
            font-size: 1.25rem;
            line-height: 1;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: rotate(90deg);
        }

        /* Mobile Collapsible Header */
        .mobile-toggle {
            display: none;
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(59, 130, 246, 0.3);
            width: 60px;
            height: 4px;
            border-radius: 2px;
            cursor: pointer;
            transition: var(--transition-smooth);
        }

        .mobile-toggle::after {
            content: '‚åÉ';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(180deg);
            color: var(--text-secondary);
            font-size: 1rem;
            transition: var(--transition-smooth);
        }

        .header.collapsed .mobile-toggle::after {
            transform: translate(-50%, -50%) rotate(0deg);
        }

        /* Responsive */
        @media (max-width: 1400px) {
            .room-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            }
        }

        @media (max-width: 1200px) {
            .filter-pills {
                flex-wrap: nowrap;
                padding: 1rem;
            }
            
            .filter-pill {
                flex-shrink: 0;
                padding: 0.5rem 0.875rem;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 1024px) {
            .header-content {
                flex-wrap: wrap;
            }
            
            .stats-bar {
                order: 3;
                width: 100%;
                justify-content: space-between;
            }
            
            .room-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 0.75rem;
                padding: 1rem;
            }
        }

        @media (max-width: 768px) {
            /* Mobile Scrollable Layout */
            body {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .mobile-toggle {
                display: block;
            }

            .header {
                position: static;
                width: 100%;
                transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
                min-width: 100vw;
            }

            .header.collapsed {
                /* Header diventa pi√π compatto ma non scompare */
                max-height: 60px;
                overflow: hidden;
            }

            .header-content {
                flex-direction: column;
                gap: 0.75rem;
                padding-bottom: 1rem;
            }

            .logo {
                font-size: 1.25rem;
            }

            .stats-bar {
                gap: 0.5rem;
                width: 100%;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
            }

            .stats-bar::-webkit-scrollbar {
                display: none;
            }

            .stat-item {
                padding: 0.5rem;
                min-width: 80px;
            }

            .stat-value {
                font-size: 1.25rem;
            }

            .stat-label {
                font-size: 0.625rem;
            }

            .controls {
                width: 100%;
                flex-wrap: nowrap;
                justify-content: flex-start;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
                gap: 0.75rem;
            }

            .controls::-webkit-scrollbar {
                display: none;
            }

            .search-box {
                min-width: 200px;
                flex-shrink: 0;
            }

            .search-input {
                width: 100%;
            }

            .filter-btn, .view-toggle {
                flex-shrink: 0;
                min-width: fit-content;
            }

            .view-toggle #viewText {
                display: none;
            }

            .view-toggle {
                padding: 0.5rem !important;
                min-width: 40px !important;
                height: 40px !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
            }

            .search-input {
                height: 40px !important;
            }

            .filter-pills {
                position: static;
                padding: 0.75rem 1rem;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                flex-wrap: nowrap;
                margin: 0;
                max-width: 100%;
            }

            .filter-pills::-webkit-scrollbar {
                display: none;
            }

            .filter-pill {
                flex-shrink: 0;
                padding: 0.375rem 0.75rem;
                font-size: 0.75rem;
            }
            
            .room-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
                gap: 0.5rem;
                padding: 0.5rem;
                min-width: 100vw;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .room-card {
                height: 100px;
                padding: 0.5rem;
            }

            /* Alarm room card mobile styles */
            .alarm-room-card {
                height: 60px;
                padding: 0.5rem;
            }

            .alarm-room-title {
                font-size: 0.875rem;
            }

            .alarm-room-icon {
                font-size: 1rem;
            }

            .alarm-room-actions {
                flex-direction: column !important;
                gap: 0.5rem;
                align-items: center !important;
                right: 0.5rem !important;
                bottom: 0.25rem !important;
            }

            .alarm-room-btn {
                padding: 0.5rem 0.75rem;
                font-size: 0.75rem;
                border-radius: 6px;
                min-width: 90px;
            }
            
            .room-number {
                font-size: 1.125rem;
            }

            .room-type {
                font-size: 0.625rem;
                padding: 0.125rem 0.375rem;
            }

            .guest-name {
                font-size: 0.75rem;
            }

            .room-info {
                display: none;
            }

            .quick-actions {
                display: none;
            }

            .modal-content {
                margin: 1rem;
                padding: 1.5rem;
            }
        }

        /* Compact view styles */
        .compact .room-card {
            height: 80px;
            padding: 0.5rem;
        }

        .compact .room-number {
            font-size: 1.125rem;
        }

        .compact .guest-name,
        .compact .room-info {
            display: none;
        }

        .compact .room-type {
            font-size: 0.625rem;
            padding: 0.125rem 0.375rem;
        }

        /* Compact view for alarm card */
        .compact .alarm-room-card {
            height: 50px;
            padding: 0.5rem;
        }

        .compact .alarm-room-title {
            font-size: 0.875rem;
        }

        .compact .alarm-room-btn {
            padding: 0.4rem 0.6rem;
            font-size: 0.7rem;
            border-radius: 6px;
        }

        /* Loading animation */
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
            color: var(--text-secondary);
            display: none;
        }

        /* Menu Container */
        .menu-container {
            position: relative;
            z-index: 2000;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Rimossa area hover invisibile per evitare conflitti */

        /* Bottone Menu principale */
        .menu-trigger {
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            z-index: 10;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
        }

        .menu-trigger:hover svg {
            transform: scale(1.1);
            stroke: rgba(255, 255, 255, 1);
        }

        .menu-trigger.active svg {
            transform: rotate(180deg) scale(1.1);
            stroke: rgba(255, 255, 255, 1);
        }

        .menu-trigger svg {
            width: 32px;
            height: 32px;
            transition: all 0.3s ease;
            stroke: rgba(255, 255, 255, 0.8);
        }

        /* Menu Items */
        .menu-items {
            position: absolute;
            top: 0;
            right: 0;
        }

        .menu-item {
            position: absolute;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            opacity: 0;
            transform: translate(0, 0) scale(0);
            pointer-events: none;
            padding: 5px;
        }

        .menu-item.active {
            opacity: 1;
            pointer-events: auto;
            transform: scale(1);
        }

        /* Posizionamento radiale delle icone */
        /* Centro: esattamente al centro del bottone menu (0,0) */
        /* Angolo incrementale: 90¬∞ / 7 = 12.857¬∞ per icona */
        /* Raggio esterno: 160px, Raggio interno: 110px (allargati) */
        
        /* 1. Camere - Esterno - 0¬∞ (sinistra pura) */
        .menu-item.active:nth-child(1) {
            transform: translate(-180px, 0px) scale(1);
            transition-delay: 0.05s;
        }

        /* 2. Card - Interno - 12.857¬∞ */
        .menu-item.active:nth-child(2) {
            transform: translate(-128px, 35px) scale(0.9);
            transition-delay: 0.1s;
        }

        /* 3. Planner - Esterno - 25.714¬∞ */
        .menu-item.active:nth-child(3) {
            transform: translate(-164px, 80px) scale(1);
            transition-delay: 0.15s;
        }

        /* 4. Clienti - Interno - 38.571¬∞ */
        .menu-item.active:nth-child(4) {
            transform: translate(-107px, 80px) scale(0.9);
            transition-delay: 0.2s;
        }

        /* 5. Parti comuni - Esterno - 51.429¬∞ */
        .menu-item.active:nth-child(5) {
            transform: translate(-123px, 143px) scale(1);
            transition-delay: 0.25s;
        }

        /* 6. Log - Interno - 64.286¬∞ */
        .menu-item.active:nth-child(6) {
            transform: translate(-68px, 120px) scale(0.9);
            transition-delay: 0.3s;
        }

        /* 7. Settings - Esterno - 77.143¬∞ */
        .menu-item.active:nth-child(7) {
            transform: translate(-60px, 174px) scale(1);
            transition-delay: 0.35s;
        }

        .menu-item:hover svg {
            stroke: #ffffff;
            transform: scale(1.3);
            filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.8));
        }

        .menu-item:hover::before {
            content: '';
            position: absolute;
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            border-radius: 50%;
            z-index: -1;
            animation: pulse-glow 0.5s ease;
        }

        @keyframes pulse-glow {
            0% {
                transform: scale(0.8);
                opacity: 0;
            }
            50% {
                transform: scale(1.2);
                opacity: 1;
            }
            100% {
                transform: scale(1);
                opacity: 0.8;
            }
        }

        .menu-item:hover .tooltip {
            display: none;
        }

        /* Label sotto il menu */
        .menu-label {
            position: absolute;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 12px;
            font-weight: 500;
            letter-spacing: 0.6px;
            opacity: 0;
            transition: opacity 0.3s ease;
            text-align: center;
            min-width: 100px;
            pointer-events: none;
            text-transform: uppercase;
            line-height: 1.2;
            white-space: pre-line;
        }

        .menu-label.active {
            opacity: 0.9;
        }

        /* Tooltips */
        .tooltip {
            position: absolute;
            right: 100%;
            top: 50%;
            transform: translateX(-100%) translateY(-50%);
            background: rgba(255, 255, 255, 0.95);
            color: #0a0a0a;
            padding: 8px 12px;
            border-radius: 4px;
            white-space: nowrap;
            font-size: 13px;
            font-weight: 500;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            margin-right: 15px;
            letter-spacing: 0.3px;
        }

        .tooltip::after {
            content: '';
            position: absolute;
            right: -6px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-left: 6px solid rgba(255, 255, 255, 0.95);
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
        }

        /* SVG Icons */
        .menu-item svg {
            width: 28px;
            height: 28px;
            stroke: rgba(255, 255, 255, 0.7);
            stroke-width: 1.5;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
            transition: all 0.3s ease;
        }

        /* Icone del secondo livello pi√π piccole */
        .menu-item:nth-child(5) svg,
        .menu-item:nth-child(6) svg,
        .menu-item:nth-child(7) svg {
            width: 24px;
            height: 24px;
            opacity: 0.9;
        }

        /* Animazione glow per il menu trigger */
        @keyframes glow {
            0% {
                filter: drop-shadow(0 0 2px rgba(255, 255, 255, 0.5));
            }
            50% {
                filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.8));
            }
            100% {
                filter: drop-shadow(0 0 2px rgba(255, 255, 255, 0.5));
            }
        }

        .menu-trigger.pulse svg {
            animation: glow 3s infinite;
        }

        /* Content principale - effetto blur */
        .header,
        .filter-pills,
        .room-grid {
            transition: filter 0.3s ease;
        }

        .header.blurred,
        .filter-pills.blurred,
        .room-grid.blurred {
            filter: blur(8px);
            pointer-events: none;
        }

        /* Il menu container non viene mai sfocato */
        .menu-container {
            filter: none !important;
        }

        /* Mobile adjustments per menu */
        @media (max-width: 768px) {
            .menu-container {
                top: 20px;
                right: 20px;
            }

            .menu-item svg {
                width: 24px;
                height: 24px;
            }
        }

    </style>
</head>
<body>
    <!-- Header -->
    <header class="header" id="header">
        <div class="header-content">
            <div class="logo">
                Hotel Paradiso
            </div>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value" id="occupiedRooms">0</div>
                    <div class="stat-label">Occupate</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="availableRooms">0</div>
                    <div class="stat-label">Disponibili</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="alertRooms">0</div>
                    <div class="stat-label">Allarmi</div>
                </div>
            </div>
            
            <div class="controls">
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" class="search-input" placeholder="Cerca camera o ospite...">
                </div>
                <button class="view-toggle" onclick="toggleView()">
                    <span id="viewIcon" style="font-size: 1.3rem; display: inline-block; width: 1.2em; text-align: center;">‚ò∞</span>
                    <span id="viewText">Compatta</span>
                </button>
                <!-- Menu Container -->
                <div class="menu-container">
                    <!-- Menu Trigger Button -->
                    <div class="menu-trigger pulse" id="menuTrigger">
                        <svg viewBox="0 0 24 24" stroke="currentColor">
                            <path d="M3 12h18M3 6h18M3 18h18"/>
                        </svg>
                    </div>

                    <!-- Menu Items -->
                    <div class="menu-items">
                        <!-- 1. Pannello camere (Alto esterno) -->
                        <div class="menu-item" data-menu="rooms" data-label="Camere">
                            <svg viewBox="0 0 24 24">
                                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                                <path d="M9 22V12h6v10"/>
                            </svg>
                            <span class="tooltip">Pannello camere</span>
                        </div>

                        <!-- 2. Gestione card / chiavi (Alto interno) -->
                        <div class="menu-item" data-menu="keys" data-label="Card">
                            <svg viewBox="0 0 24 24">
                                <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
                            </svg>
                            <span class="tooltip">Gestione card / chiavi</span>
                        </div>

                        <!-- 3. Planner prenotazioni (Medio esterno) -->
                        <div class="menu-item" data-menu="planner" data-label="Planner">
                            <svg viewBox="0 0 24 24">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                                <line x1="16" y1="2" x2="16" y2="6"/>
                                <line x1="8" y1="2" x2="8" y2="6"/>
                                <line x1="3" y1="10" x2="21" y2="10"/>
                                <path d="M8 14h.01M12 14h.01M16 14h.01M8 18h.01M12 18h.01M16 18h.01"/>
                            </svg>
                            <span class="tooltip">Planner prenotazioni</span>
                        </div>

                        <!-- 4. Anagrafica clienti (Basso esterno) -->
                        <div class="menu-item" data-menu="clients" data-label="Clienti">
                            <svg viewBox="0 0 24 24">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                <circle cx="9" cy="7" r="4"/>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/>
                            </svg>
                            <span class="tooltip">Anagrafica clienti</span>
                        </div>

                        <!-- 5. Aree comuni - domotica (Medio interno) -->
                        <div class="menu-item" data-menu="automation" data-label="Parti comuni">
                            <svg viewBox="0 0 24 24">
                                <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
                            </svg>
                            <span class="tooltip">Aree comuni - Domotica</span>
                        </div>

                        <!-- 6. Log accessi e allarmi (Medio interno) -->
                        <div class="menu-item" data-menu="logs" data-label="Log">
                            <svg viewBox="0 0 24 24">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8"/>
                            </svg>
                            <span class="tooltip">Log accessi e allarmi</span>
                        </div>

                        <!-- 7. Settings (Basso interno) -->
                        <div class="menu-item" data-menu="settings" data-label="Settings">
                            <svg viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="3"/>
                                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                            </svg>
                            <span class="tooltip">Settings</span>
                        </div>
                    </div>
                    
                    <!-- Label sotto il menu -->
                    <div class="menu-label" id="menuLabel"></div>
                </div>
            </div>
        </div>
        <div class="mobile-toggle" onclick="toggleHeader()"></div>
    </header>



    <!-- Filter Pills -->
    <div class="filter-pills">
        <div class="filter-pill active" data-filter="all">
            <span>üìç</span>
            <span>Tutte</span>
        </div>
        <div class="filter-pill" data-filter="floor-1">
            <span>1Ô∏è‚É£</span>
            <span>Piano 1</span>
        </div>
        <div class="filter-pill" data-filter="floor-2">
            <span>2Ô∏è‚É£</span>
            <span>Piano 2</span>
        </div>
        <div class="filter-pill" data-filter="floor-3">
            <span>3Ô∏è‚É£</span>
            <span>Piano 3</span>
        </div>
        <div class="filter-pill" data-filter="floor-4">
            <span>4Ô∏è‚É£</span>
            <span>Piano 4</span>
        </div>
        <div class="filter-pill" data-filter="free">
            <span>üü¢</span>
            <span>Libere</span>
        </div>
        <div class="filter-pill" data-filter="occupied">
            <span>üîµ</span>
            <span>Occupate</span>
        </div>
        <div class="filter-pill" data-filter="assigned">
            <span>üü†</span>
            <span>Assegnate</span>
        </div>
        <div class="filter-pill" data-filter="maintenance">
            <span>üü°</span>
            <span>Manutenzione</span>
        </div>
    </div>

    <!-- Room Grid -->
    <div class="room-grid" id="roomGrid"></div>

    <!-- Modal -->
    <div class="modal" id="roomModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Camera 101</h2>
                <button class="close-btn" onclick="closeModal()">√ó</button>
            </div>
            <div id="modalBody">
                <!-- Modal content will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Loading -->
    <div class="loading" id="loading">Caricamento...</div>

    <script>
        // Data Generation
        const guestNames = [
            'Mario Rossi', 'Anna Bianchi', 'Luigi Verdi', 'Maria Romano', 'Giuseppe Ricci',
            'Francesca Marino', 'Antonio Greco', 'Paola Bruno', 'Giovanni Gallo', 'Laura Conti',
            'Roberto Leone', 'Giulia Longo', 'Andrea Mancini', 'Sara Marini', 'Marco Ferrara',
            'Chiara Rinaldi', 'Stefano Caruso', 'Valentina Ferretti', 'Davide Martini', 'Alessia Serra'
        ];

        const roomTypes = ['Standard', 'Deluxe', 'Suite', 'Junior Suite', 'Executive'];
        const statuses = ['free', 'occupied', 'assigned', 'maintenance', 'alarm', 'checkout', 'cleaning'];
        const statusTexts = {
            free: 'Libera',
            occupied: 'Occupata',
            assigned: 'Assegnata',
            maintenance: 'Manutenzione',
            alarm: 'Allarme',
            checkout: 'Check-out oggi',
            cleaning: 'Pulizia'
        };

        let rooms = [];
        let currentFilter = 'all';
        let activeFilters = new Set(['all']);
        let isCompactView = false;
        let isAlarmActive = true;
        let isAlarmMuted = false;

        // Generate rooms - forziamo alcune camere in allarme per test
        function generateRooms() {
            rooms = [];
            let alarmCount = 0;
            for (let floor = 1; floor <= 4; floor++) {
                for (let room = 1; room <= 32; room++) {
                    const roomNumber = floor * 100 + room;
                    // Forziamo le prime 3 camere di ogni piano in allarme per test
                    let status;
                    if (room <= 3 && alarmCount < 12) {
                        status = 'alarm';
                        alarmCount++;
                    } else {
                        status = statuses[Math.floor(Math.random() * statuses.length)];
                    }
                    
                    const roomData = {
                        number: roomNumber,
                        floor: floor,
                        type: roomTypes[Math.floor(Math.random() * roomTypes.length)],
                        status: status,
                        guest: status === 'occupied' || status === 'checkout' ? 
                               guestNames[Math.floor(Math.random() * guestNames.length)] : null,
                        temperature: 20 + Math.floor(Math.random() * 5),
                        nights: status === 'occupied' ? Math.floor(Math.random() * 7) + 1 : 0
                    };
                    rooms.push(roomData);
                }
            }
            updateStats();
        }

        // Update statistics
        function updateStats() {
            const occupied = rooms.filter(r => r.status === 'occupied').length;
            const available = rooms.filter(r => r.status === 'free').length;
            const alerts = rooms.filter(r => r.status === 'alarm').length;
            
            document.getElementById('occupiedRooms').textContent = occupied;
            document.getElementById('availableRooms').textContent = available;
            document.getElementById('alertRooms').textContent = alerts;
        }

        // Create alarm room card
        function createAlarmRoomCard() {
            const alarmCard = document.createElement('div');
            alarmCard.className = 'alarm-room-card';
            alarmCard.id = 'alarmRoomCard';
            
            // Create header
            const header = document.createElement('div');
            header.className = 'alarm-room-header';
            header.innerHTML = `
                <div class="alarm-room-title">
                    <span class="alarm-room-icon">‚ö†Ô∏è</span>
                    <span>ALLARME caldaia piano -1</span>
                </div>
            `;
            
            // Create actions container
            const actions = document.createElement('div');
            actions.className = 'alarm-room-actions';
            
            // Create disable button
            const disableBtn = document.createElement('button');
            disableBtn.className = 'alarm-room-btn primary';
            disableBtn.onclick = disableAlarmRoom;
            disableBtn.innerHTML = '<span>‚ùå</span><span>Disattiva</span>';
            
            // Create mute button
            const muteBtn = document.createElement('button');
            muteBtn.className = isAlarmMuted ? 'alarm-room-btn muted' : 'alarm-room-btn';
            muteBtn.onclick = muteAlarmRoom;
            
            if (isAlarmMuted) {
                muteBtn.innerHTML = '<span>üîá</span><span>Tacitato</span>';
            } else {
                muteBtn.innerHTML = '<span>üîä</span><span>Tacita</span>';
            }
            
            // Append buttons to actions
            actions.appendChild(disableBtn);
            actions.appendChild(muteBtn);
            
            // Append all elements to card
            alarmCard.appendChild(header);
            alarmCard.appendChild(actions);
            
            return alarmCard;
        }

        // Render rooms
        function renderRooms() {
            const grid = document.getElementById('roomGrid');
            grid.innerHTML = '';
            
            // Add alarm card if alarm is active
            if (isAlarmActive) {
                const alarmCard = createAlarmRoomCard();
                grid.appendChild(alarmCard);
            }
            
            let filteredRooms = rooms;
            
            // Apply multiple filters
            if (!activeFilters.has('all')) {
                filteredRooms = rooms.filter(room => {
                    // Check floor filters
                    let floorMatch = true;
                    const floorFilters = Array.from(activeFilters).filter(f => f.startsWith('floor-'));
                    if (floorFilters.length > 0) {
                        floorMatch = floorFilters.some(f => {
                            const floor = parseInt(f.split('-')[1]);
                            return room.floor === floor;
                        });
                    }
                    
                    // Check status filters
                    let statusMatch = true;
                    const statusFilters = Array.from(activeFilters).filter(f => !f.startsWith('floor-') && f !== 'all');
                    if (statusFilters.length > 0) {
                        statusMatch = statusFilters.includes(room.status);
                    }
                    
                    return floorMatch && statusMatch;
                });
            }
            
            filteredRooms.forEach(room => {
                const card = createRoomCard(room);
                grid.appendChild(card);
            });
        }

        // Create room card
        function createRoomCard(room) {
            const card = document.createElement('div');
            card.className = `room-card ${room.status}`;
            card.onclick = () => openModal(room);
            
            card.innerHTML = `
                <div>
                    <div class="room-header">
                        <div class="room-number">${room.number}</div>
                        <div class="room-type">${room.type}</div>
                    </div>
                    <div class="room-status">
                        <div class="status-icon"></div>
                        <div class="status-text">${statusTexts[room.status]}</div>
                    </div>
                    ${room.guest ? `<div class="guest-name">üë§ ${room.guest}</div>` : ''}
                    <div class="room-info">
                        <div class="info-item">üå°Ô∏è ${room.temperature}¬∞</div>
                        ${room.nights ? `<div class="info-item">üìÖ ${room.nights} notti</div>` : ''}
                    </div>
                </div>
                <div class="quick-actions">
                    <button class="action-btn" onclick="event.stopPropagation(); toggleLight(${room.number})">üí°</button>
                    <button class="action-btn" onclick="event.stopPropagation(); adjustClimate(${room.number})">‚ùÑÔ∏è</button>
                    <button class="action-btn" onclick="event.stopPropagation(); toggleTV(${room.number})">üì∫</button>
                </div>
            `;
            
            return card;
        }

        // Modal functions
        function openModal(room) {
            const modal = document.getElementById('roomModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            
            modalTitle.textContent = `Camera ${room.number} - ${room.type}`;
            modalBody.innerHTML = `
                <div style="display: grid; gap: 1.5rem;">
                    ${room.status === 'alarm' ? `
                    <div id="alarmSection" style="background: rgba(239, 68, 68, 0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(239, 68, 68, 0.3);">
                        <h3 style="margin-bottom: 1rem; color: #ef4444; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em;">‚ö†Ô∏è Allarme Attivo</h3>
                        <p style="color: #fca5a5; margin-bottom: 1rem;">Rilevato movimento anomalo alle 03:45</p>
                        <button onclick="disableAlarm(${room.number})" style="background: rgba(239, 68, 68, 0.2); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; padding: 0.75rem 1.5rem; color: white; cursor: pointer; width: 100%; font-weight: 600;">
                            Disattiva Allarme
                        </button>
                    </div>
                    ` : ''}
                    
                    <div style="background: rgba(255,255,255,0.03); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(255,255,255,0.1);">
                        <h3 style="margin-bottom: 1rem; color: #a8a8b3; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em;">Informazioni</h3>
                        <div style="display: grid; gap: 0.75rem;">
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: #a8a8b3;">Stato:</span>
                                <span style="font-weight: 600;">${statusTexts[room.status]}</span>
                            </div>
                            ${room.guest ? `
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: #a8a8b3;">Ospite:</span>
                                <span style="font-weight: 600;">${room.guest}</span>
                            </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;
            
            modal.classList.add('active');
        }

        function closeModal() {
            const modal = document.getElementById('roomModal');
            modal.classList.remove('active');
        }

        // Quick action functions (simulated)
        function toggleLight(roomNumber) {
            console.log(`Toggling light for room ${roomNumber}`);
            showNotification(`üí° Luci camera ${roomNumber} cambiate`);
        }

        function adjustClimate(roomNumber) {
            console.log(`Adjusting climate for room ${roomNumber}`);
            showNotification(`‚ùÑÔ∏è Clima camera ${roomNumber} regolato`);
        }

        function toggleTV(roomNumber) {
            console.log(`Toggling TV for room ${roomNumber}`);
            showNotification(`üì∫ TV camera ${roomNumber} controllata`);
        }

        // Disable alarm function
        function disableAlarm(roomNumber) {
            const alarmSection = document.getElementById('alarmSection');
            if (alarmSection) {
                alarmSection.style.animation = 'fadeOut 0.3s ease-out';
                setTimeout(() => {
                    alarmSection.remove();
                    // Update room status in data
                    const room = rooms.find(r => r.number === roomNumber);
                    if (room) {
                        room.status = 'free';
                        updateStats();
                        renderRooms();
                    }
                }, 300);
            }
            showNotification(`‚úÖ Allarme camera ${roomNumber} disattivato`);
        }

        // View toggle
        function toggleView() {
            isCompactView = !isCompactView;
            document.body.classList.toggle('compact');
            document.getElementById('viewText').textContent = isCompactView ? 'Normale' : 'Compatta';
            const iconElement = document.getElementById('viewIcon');
            if (isCompactView) {
                iconElement.textContent = '‚â£';
                iconElement.style.fontSize = '1.6rem';
            } else {
                iconElement.textContent = '‚ò∞';
                iconElement.style.fontSize = '1.3rem';
            }
        }

        // Mobile header toggle
        function toggleHeader() {
            const header = document.getElementById('header');
            header.classList.toggle('collapsed');
        }

        // Disable alarm room card
        function disableAlarmRoom() {
            isAlarmActive = false;
            isAlarmMuted = false;
            showNotification('‚úÖ Allarme sistema disattivato');
            renderRooms(currentFilter);
        }

        // Mute alarm room card
        function muteAlarmRoom() {
            isAlarmMuted = !isAlarmMuted;
            const message = isAlarmMuted ? 'üîá Allarme tacitato' : 'üîä Allarme riattivato';
            showNotification(message);
            
            // Update the mute button in the existing card
            const alarmCard = document.getElementById('alarmRoomCard');
            if (alarmCard) {
                const muteBtn = alarmCard.querySelector('.alarm-room-actions button:last-child');
                if (muteBtn) {
                    const muteButtonContent = isAlarmMuted 
                        ? '<span>üîá</span><span>Tacitato</span>'
                        : '<span>üîä</span><span>Tacita</span>';
                    
                    muteBtn.className = isAlarmMuted ? 'alarm-room-btn muted' : 'alarm-room-btn';
                    muteBtn.innerHTML = muteButtonContent;
                }
            }
        }

        // Notification system
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                bottom: 2rem;
                right: 2rem;
                background: rgba(59, 130, 246, 0.9);
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                animation: slideInRight 0.3s ease-out;
                z-index: 2000;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease-out';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Add notification animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    opacity: 0;
                    transform: translateX(100%);
                }
                to {
                    opacity: 1;
                    transform: translateX(0);
                }
            }
            
            @keyframes slideOutRight {
                from {
                    opacity: 1;
                    transform: translateX(0);
                }
                to {
                    opacity: 0;
                    transform: translateX(100%);
                }
            }
            
            @keyframes fadeOut {
                from {
                    opacity: 1;
                    transform: scale(1);
                }
                to {
                    opacity: 0;
                    transform: scale(0.95);
                }
            }
        `;
        document.head.appendChild(style);

        // Filter functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Generate initial rooms
            generateRooms();
            renderRooms();
            
            // Filter pills click handler
            document.querySelectorAll('.filter-pill').forEach(pill => {
                pill.addEventListener('click', function() {
                    const filter = this.dataset.filter;
                    
                    if (filter === 'all') {
                        // Reset all filters
                        document.querySelectorAll('.filter-pill').forEach(p => p.classList.remove('active'));
                        this.classList.add('active');
                        activeFilters.clear();
                        activeFilters.add('all');
                    } else {
                        // Toggle filter
                        if (activeFilters.has(filter)) {
                            // Remove filter
                            activeFilters.delete(filter);
                            this.classList.remove('active');
                            
                            // If no filters, activate "all"
                            if (activeFilters.size === 0 || (activeFilters.size === 1 && activeFilters.has('all'))) {
                                activeFilters.clear();
                                activeFilters.add('all');
                                document.querySelector('[data-filter="all"]').classList.add('active');
                            }
                        } else {
                            // Add filter
                            activeFilters.delete('all');
                            document.querySelector('[data-filter="all"]').classList.remove('active');
                            activeFilters.add(filter);
                            this.classList.add('active');
                        }
                    }
                    
                    renderRooms();
                });
            });
            
            // Search functionality
            const searchInput = document.querySelector('.search-input');
            searchInput.addEventListener('input', function(e) {
                const searchTerm = e.target.value.toLowerCase();
                const cards = document.querySelectorAll('.room-card');
                
                cards.forEach(card => {
                    const roomNumber = card.querySelector('.room-number').textContent;
                    const guestName = card.querySelector('.guest-name');
                    const guestText = guestName ? guestName.textContent.toLowerCase() : '';
                    
                    if (roomNumber.includes(searchTerm) || guestText.includes(searchTerm)) {
                        card.style.display = '';
                    } else {
                        card.style.display = 'none';
                    }
                });
            });
            
            // Close modal on escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeModal();
                }
            });
            
            // Close modal on background click
            document.getElementById('roomModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });
            
            // Simulate real-time updates
            setInterval(() => {
                // Randomly update a room status
                if (Math.random() > 0.9) {
                    const randomRoom = rooms[Math.floor(Math.random() * rooms.length)];
                    const oldStatus = randomRoom.status;
                    const newStatuses = statuses.filter(s => s !== oldStatus);
                    randomRoom.status = newStatuses[Math.floor(Math.random() * newStatuses.length)];
                    
                    if (randomRoom.status === 'occupied' || randomRoom.status === 'checkout') {
                        randomRoom.guest = guestNames[Math.floor(Math.random() * guestNames.length)];
                        randomRoom.nights = Math.floor(Math.random() * 7) + 1;
                    } else {
                        randomRoom.guest = null;
                        randomRoom.nights = 0;
                    }
                    
                    updateStats();
                    renderRooms();
                }
                
                // Update temperatures
                rooms.forEach(room => {
                    if (Math.random() > 0.95) {
                        room.temperature = 20 + Math.floor(Math.random() * 5);
                    }
                });
            }, 5000);
            
            // Touch swipe for mobile header
            let touchStartY = 0;
            let touchEndY = 0;
            
            document.addEventListener('touchstart', function(e) {
                touchStartY = e.changedTouches[0].screenY;
            });
            
            document.addEventListener('touchend', function(e) {
                touchEndY = e.changedTouches[0].screenY;
                handleSwipe();
            });
            
            function handleSwipe() {
                const header = document.getElementById('header');
                const swipeDistance = touchStartY - touchEndY;
                
                if (Math.abs(swipeDistance) > 50) {
                    if (swipeDistance > 0 && touchStartY < 100) {
                        // Swipe up from top - collapse header
                        header.classList.add('collapsed');
                    } else if (swipeDistance < 0 && header.classList.contains('collapsed')) {
                        // Swipe down - expand header
                        header.classList.remove('collapsed');
                    }
                }
            }
        });

        // Menu functionality
        const menuTrigger = document.getElementById('menuTrigger');
        const menuItems = document.querySelectorAll('.menu-item');
        const menuLabel = document.getElementById('menuLabel');
        const menuContainer = document.querySelector('.menu-container');
        let isMenuOpen = false;

        // Semplice logica hover senza conflitti
        let hoverTimeout;

        menuContainer.addEventListener('mouseenter', () => {
            clearTimeout(hoverTimeout);
            if (!isMenuOpen) {
                openMenu();
            }
        });

        menuContainer.addEventListener('mouseleave', () => {
            clearTimeout(hoverTimeout);
            hoverTimeout = setTimeout(() => {
                if (isMenuOpen) {
                    closeMenu();
                }
            }, 100); // Piccolo delay per evitare chiusure accidentali
        });

        // Mobile touch support
        if ('ontouchstart' in window) {
            menuTrigger.addEventListener('click', (e) => {
                e.stopPropagation();
                toggleMenu();
            });

            document.addEventListener('click', (e) => {
                if (isMenuOpen && !e.target.closest('.menu-container')) {
                    closeMenu();
                }
            });
        }

        // Handle hover on menu items
        menuItems.forEach(item => {
            item.addEventListener('mouseenter', () => {
                let label = item.dataset.label;
                // Metti "Parti comuni" su due righe
                if (label === 'Parti comuni') {
                    label = 'Parti\ncomuni';
                }
                menuLabel.textContent = label;
                menuLabel.classList.add('active');
            });

            item.addEventListener('mouseleave', () => {
                menuLabel.classList.remove('active');
                setTimeout(() => {
                    if (!menuLabel.classList.contains('active')) {
                        menuLabel.textContent = '';
                    }
                }, 300);
            });
        });

        function toggleMenu() {
            if (isMenuOpen) {
                closeMenu();
            } else {
                openMenu();
            }
        }

        function openMenu() {
            if (isMenuOpen) return;
            isMenuOpen = true;
            menuTrigger.classList.add('active');
            menuTrigger.classList.remove('pulse');
            
            // Applica effetto blur ai singoli elementi (escludendo il menu)
            const header = document.querySelector('.header');
            const filterPills = document.querySelector('.filter-pills');
            const roomGrid = document.querySelector('.room-grid');
            
            if (header) header.classList.add('blurred');
            if (filterPills) filterPills.classList.add('blurred');
            if (roomGrid) roomGrid.classList.add('blurred');
            
            menuItems.forEach((item, index) => {
                setTimeout(() => {
                    item.classList.add('active');
                }, index * 30);
            });
        }

        function closeMenu() {
            if (!isMenuOpen) return;
            isMenuOpen = false;
            menuTrigger.classList.remove('active');
            menuLabel.classList.remove('active');
            menuLabel.textContent = '';
            
            // Rimuovi effetto blur
            const header = document.querySelector('.header');
            const filterPills = document.querySelector('.filter-pills');
            const roomGrid = document.querySelector('.room-grid');
            
            if (header) header.classList.remove('blurred');
            if (filterPills) filterPills.classList.remove('blurred');
            if (roomGrid) roomGrid.classList.remove('blurred');
            
            menuItems.forEach((item) => {
                item.classList.remove('active');
            });
            
            // Riattiva l'animazione glow dopo un po'
            setTimeout(() => {
                if (!isMenuOpen) {
                    menuTrigger.classList.add('pulse');
                }
            }, 1000);
        }

        // Handle menu item clicks
        menuItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.stopPropagation();
                const menuType = item.dataset.menu;
                const label = item.dataset.label;
                console.log(`Navigating to: ${menuType}`);
                
                // Qui puoi aggiungere la navigazione effettiva
                showNotification(`Apertura: ${label}`);
                
                // Chiudi il menu dopo la selezione
                closeMenu();
            });
        });
    </script>
</body>
</html>